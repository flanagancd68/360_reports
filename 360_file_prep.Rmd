---
title: 'IMPORTANT: 360 file prep'
table_of_contents: yes
output: html_notebook
---
# This document is important! -------------------------------------------------
- Failure to adhere to these specifications will result in one of the following:
    - You will get an error when trying to run the main script
        - The error may not necessarily be upon file import but could be down in the middle of some other analysis 
    - You will **NOT** get an error (which is actually worse!)
        - The routine will run as if your files are formatted appropriatley resulting in reports that _look_ normal but are actually flawed
        - This means your conclusions may also be flawed

# Initial set-up -----------------------------------
1. Download and install R (aka "Base R")
1. Download and install Rstudio
1. Launch Rstudio
    a. File | New Project | Version Control | Git
    b. repository url: https://github.com/flanagancd68/360_reports.git
    c. project directory `360_reports` (should default to this)
    c. create project as a subdirectory of:
        a. This is up to you but make it somewhere you can find it later!
    c. You do not need a github account unless you want to "push" any suggested changes and make them available to everyone.  Feel free to contact me if you wish to become a contributer to the project.
2. In Windows/File Explorer
    a. under `360_reports`, create subdirectories `1`, `2`, `3`, etc for each 360 server/hub
    a. if you only have one server, you only need to create a `1` folder
    b. This is where the program will be looking for your 360 data files
    c. there should already be a subdirectory `external` - this is where various CMS files reside.  These will be updated annually.
    c. there should be a subdirectory `internal`
        a. please update the xlsx file with your facility specific data
        b. We're trying to be as accomodating as we can from single-facility to multiple-facility/single-hub, to multiple-facility/multiple-hub environments
        c. even if you only have a single facility, please update the xlsx with your facility nformation - this will allow everyone to use the same code.
        c. important! save as `fac_codes.xlsx` in the `internal` subdirectory
        
3. Follow the instructions in **360 reports how-to** to compile, reformat and save 360 reports.  If you have multiple hubs, make sure you are saving the report xlsx files in the applicable hub subdirectory:        
    
    
# 360 reports how to -----------------------------------------------------------

1. log into 360 for the given hub
2. click reports (upper right)
2. Select the designated report and adjust the report parameters as indicated below
    -  Several reports will have multiple versions needed
        - one for inpatient (ip) and one for outpatient (op)
        - one for diagnoses (dx) and one for procedures (dx)
        - one for coder (cdr) and one for facility (fac)
        - as applicable, we append the abbreviations as suffixes to the report name for easier identification
    -  As of the date of this writing, the OP and IP NLP engines are distinct.  When it comes to NLP engine tuning opportunities, we want to be specific as to which engine.
    - From a coder standpoint, ICD-10-CM, ICD-10-PCS, and CPT/HCPCS are three completely different coding schemes.  When it comes to coder education opportunities, we similarly want to be specific as to which type of coding.
1. After you run each report for the first time you will want to save your criteria
    - This will save time in the future
    - *After* a report has compiled, click **"Save As..."** to save the report criteria
    - The suggested name is provided below (substitute "cf" for the person who will be running the reports)
    - Another benefit to saved reports is that if you used "quarter -1" as your date range, when you run the saved report the next quarter, the dates should automatically adjust
1. Next after the report has compiled you will need to **Export To** Excel for some basic file prep
    - Save or open the downloaded file in Excel
    - We want the first rown of every xlsx to be the header information for the table; you will need to delete the report parameters
    - For certain "grouped" reports, you will need to copy-down the group information to attach it to each row (usually the coder or facility)
    - this is a very simple formula
    - Lastly you will need to save it as a .xlsx file
        - there is an excel macro available that makes this faster
        - load the macro (as allowed by your facility IT department), then add it to your 'quick access' toolbar
1. generally we will be using 'HIM Coding Reports' but there is one CDI report
1. For additional assistance or information please visit https://apps.3mhis.com/download/3M_Docs_Secured/360_Encompass/360_P2_library/index.htm#reports_360v2.htm

# **09d** | Physician query listing -------------------------------------------
1. Purpose: detect query pattern variance among coders
1. one file needed: YYQ#_09d.xlsx (e.g. "19Q1_09d.xlsx")
1. Parameters:
    1. **Save As...** 
        - cf_09d_cdr_fac (*note*: usual suffix is minimum necessary grouping but since this is a coder report in the CDI section, recommend more specific; when we save the xlsx file we can drop the suffix)
        - *Note*: save the criteria for every report listed below
    1. Parameters:
	     	1. Date Type: Discharge Date | From Date: First of Quarter -1 | Through Date: End of Quarter -1 (qtr -1)
	    	1. Visit Type: -All- | Patient Type:  -All- | Type of Query : -All- | Role of Query Author: Coder | Communication Type: -All- | Queried Provider Dept: -All- | Responding Provider Dept: -All- 
	    	1. Queried Provider:  -All- | Query Author: -All- | Primary Query Impact: -All- | Secondary Query Impact: -All- | Provider Response: -All- | Responding Provider: -All-
    		1. Current/Last Location: -All- | Primary Payer: -All- | Financial Class: -All- | Facility:-All- 
    		1. group 1: Query Author  | Group 2: Facility
      	1. Columns for Export: All
      	1. **Export to:** Excel format
      	    1. if given the option, "SAVE AS" | enter the filename in the format listed above, in the applicable hub folder.  Then click "open" to edit in Excel.
      	    If not given the option to save as, double click the downloaded folder and open.
      	
1. In Excel
    1. **This report does nto have a constant header row location** - special handling is required
    1. Delete down to account specific information so the row begins with: `Query Author`, `Facility`, `Total Visits` (etc)
	  1. save as "YYQ#_09d.xlsx" (where YY is the two digit year and Q# is the quarter # such as Q1, Q2, Q3, or Q4.  as stated above, you MUST name the xlsx file exactly as stated for the R script to work. Same is true for all files below)  

# **CAC001** | auto|suggested codes precision and recall -------------------
1. Purpose: detect variance and assess general effectiveness of the NLP engine. Low rates can be indicative of coder adoption or NLP tuning opportunities.
1. Four files needed:
	    1. YYQ#_CAC001_ip_dx.xlsx
	    2. YYQ#_CAC001_ip_px.xlsx
	    2. YYQ#_CAC001_op_dx.xlsx
	    2. YYQ#_CAC001_op_px.xlsx
1. Parameters
		1. Date Type: Discharge Date | From Date: First of Quarter -1 | Through Date: End of Quarter -1 
		1. 3M Patient Type: **Inpatient (then outpatient)** | Visit Type: -All- | Patient Type:  -All- 
		1. ICD Version: Billable | **Type: IDx (then IProc, then HCPCS)** | Symptom/Historical: Exclude | Codeset Type: HIM | Coder: -All- | Exclude Visits without AutoSuggested Codes: N
		    - our system does not code ICD-10-PCS on outpatients.  You may need to change at your discretion.
		1. Primary Payer: -All- | Financial Class: -All- | Facility: -All-
		1. group 1: Last Reviewer/Coder
		1. group 2: Facility


# **CAC003** | auto-suggested codes precision and recall by code ---------------------
1. Purpose: Identify low percentage acceptance of certain codes.  Can be used to evaluate coder adoption or NLP engine performance opportunities
1. Four files needed:
    1. YYQ#_CAC003_ip_cdr.xlsx
    2. YYQ#_CAC003_ip_fac.xlsx
    2. YYQ#_CAC003_op_cdr.xlsx
    2. YYQ#_CAC003_op_fac.xlsx
1. Parameters
		1. Date Type: Discharge Date | From Date: First of Quarter -1 | Through Date: End of Quarter -1 
		1. Visit Type: -All- | **Patient Type:  I (then O)** | Code: 
		1. ICD Version: Billable | Type: IDx,IPx | Symptom/Historical: Exclude | Codeset Type: HIM | Coder: -All- | **Precision Threshold : .50 | Recall Threshold : .50** | Exclude Visits without AutoSuggested Codes: N
		1. Primary Payer: -All- | Financial Class: -All- | Facility: 
		1. **Group 1: Last Reviewer/Coder (then Facility)**  


# **CAC007** All Codes Entry Method Summary ------------------------
1. Purpose: determine coder and facility CAC vs manual entry methods
    - This is a really exciting report!  We can get at coder adoption of CAC
1. eight files needed:
    1. YYQ#_CAC007_ip_dx_cdr.xlsx
    2. YYQ#_CAC007_ip_dx_fac.xlsx
    2. YYQ#_CAC007_ip_px_cdr.xlsx
    2. YYQ#_CAC007_ip_px_fac.xlsx
    1. YYQ#_CAC007_op_dx_cdr.xlsx
    2. YYQ#_CAC007_op_dx_fac.xlsx
    2. YYQ#_CAC007_op_px_cdr.xlsx
    2. YYQ#_CAC007_op_px_fac.xlsx
1. Parameters
    1. Date Type: Discharge Date | From Date: First of Quarter -1 | Through Date: End of Quarter -1  
    1. **3M Patient Type: Inpatient (then Outpatient)** | Visit Type: -All- | Patient Type:  -All- 
ICD Version: Billable | **Type: IDx (then I10 Proc, then HCPCS)** | Symptom/Historical: Exclude | Codeset Type: HIM | Coder: -All- | Exclude Visits without AutoSuggested Codes: N
    1. Primary Payer: -All- | Financial Class: -All- | Facility: -All-
    1. **Group 1: Last Reviewer/Coder (then Facility)**  

	
# **CAC008** | Auto-suggested codes listing ------------------------------------
1. Purpose: This report can be used for researching why coders may be rejecting A/S codes
1. One file needed: YYQ#_CAC008.xlsx
    - Notes: 
        - The nice thing about the output is that it contains the `Dx/Proc` and `Pt Type` fields
        - This makes it unnecessary to need to run separate versions; *however*, depending on volume of patients on your server, the resulting Excel file may be too big
        -   i.e. the report may compile but when you attempt to export to Excel, 3M will throw an error
        - The workaround is to compile for ONLY the final month of the quarter
        - we are just looking for representative accounts; we are not generating any kinds of stats from these
1. Parameters
    1. Date Type: Discharge Date | From Date: First of Quarter -1 | Through Date: End of Quarter -1  (unless you need to run one month at a time)     1. Visit Type: -All- | Patient Type:  -All-    
    1. ICD Version: Billable | Type: IDx,IPx,HCPCS | Codeset Type: HIM | Coder: -All- | Code: 
    1. Primary Payer: -All- | Financial Class: -All- | Facility: -All-  

    
# **IP004** | Primary and Secondary DRG Listing ----------------------------------------------------------
1. Purpose: Coded account inforation including DRGs
    - **Important note**: the routine assumes that you will have a secondary DRG populated 100% of the time.  
    - The script will parse out APR vs CMS DRGs, and generate reports on each
    - However if you aren't collecting secondary DRGs, **the resulting data will be skewed**  
    - Two workarounds:
        - Filter on applicable financial (e.g. Medicare only for MS-DRG)
        - If your patient accounting system is capable, you can import a flat file of patient DRG data
            - this gets complex and unfortunately is beyond my ability to assist you.  Contact your local IT department  
            - I will set up the basic infrastructure but you will likely need to tweak (especially if your system account number format doesn't match 360's)  
2. Files Needed:
    1. YYQ#_IP004.xlsx
3. Parameters
    23. Date / include secondary / primary: coder / secondary: none
    25. We need to run this file one month at a time and then manually combine in excel - you may or may not need to


# **Prod016** | Coder Productivity -----------------------
1. Purpose:
2. Files needed:
    1. YYQ#_Prod016_ip_xlsx
    2. YYQ#_Prod016_op_xlsx
3. Parameters:

    


## Make sure you have all files in all folders.
- At the end you should have the following reports in each folder

	- YYQ#_CAC001_ip_dx.xlsx
  - YYQ#_CAC001_ip_px.xlsx
  - YYQ#_CAC001_op_dx.xlsx
  - YYQ#_CAC001_op_px.xlsx
  - YYQ#_CAC003_ip_cdr.xlsx
  - YYQ#_CAC003_ip_fac.xlsx
  - YYQ#_CAC003_op_cdr.xlsx
  - YYQ#_CAC003_op_fac.xlsx
  - YYQ#_CAC007_ip_dx_cdr.xlsx
  - YYQ#_CAC007_ip_dx_fac.xlsx
  - YYQ#_CAC007_ip_px_cdr.xlsx
  - YYQ#_CAC007_ip_px_fac.xlsx
  - YYQ#_CAC007_op_dx_cdr.xlsx
  - YYQ#_CAC007_op_dx_fac.xlsx
  - YYQ#_CAC007_op_px_cdr.xlsx
  - YYQ#_CAC007_op_px_fac.xlsx
  - YYQ#_CAC008.xlsx
  - YYQ#_IP004
  - YYQ#_Prod016_ip
  - YYQ#_Prod016_op

